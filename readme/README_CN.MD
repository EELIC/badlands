
badlands å®‰è£…

git clone https://github.com/badlands-model/badlands-companion.git
git clone https://github.com/badlands-model/badlands.git
git clone https://github.com/badlands-model/badlands-workshop.git
å®‰è£…æ¶‰åŠé‡è¦æ–‡ä»¶åŠç›®å½•
badlands/
â”œâ”€â”€ badlands-companion/    â† å¯è§†åŒ–æ”¯æŒå·¥å…·
â”‚   â”œâ”€â”€ badlands-companion/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ ...å…¶ä»–...
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ setup.cfg
â”‚   â”œâ”€â”€ setup.cfg
â”‚   â””â”€â”€ ...å…¶ä»–...
â”œâ”€â”€ badlands-master/    â† ä¸»ç¨‹åº             
â”‚   â”œâ”€â”€ badlands/
â”‚   â”‚   â”œâ”€â”€ badlands/   â† æºç ä¸»åŒ… 
â”‚   â”‚   â”‚    â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚    â”œâ”€â”€ model.py
â”‚   â”‚   â”‚    â””â”€â”€ ...å…¶ä»–...
â”‚   â”‚   â”œâ”€â”€ MANIFEST.in
â”‚   â”‚   â”œâ”€â”€ meson.build
â”‚   â”‚   â”œâ”€â”€ pyproject.toml
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”‚   â”œâ”€â”€ setup.cfg
â”‚   â”‚   â””â”€â”€ setup.py
â”‚   â”œâ”€â”€ environment.yml
â”‚   â”œâ”€â”€ README.md
â”‚   â””â”€â”€ ...å…¶ä»–...
â”œâ”€â”€ badlands-workshop/  â† ç¤ºä¾‹
â”‚   â”œâ”€â”€ companion/
â”‚   â”œâ”€â”€ examples/
â”‚   â”‚   â”œâ”€â”€ basin/
â”‚   â”‚   â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”‚   â”œâ”€â”€ basin.ipynb
â”‚   â”‚   â”‚   â”œâ”€â”€ basin.xml
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»–...
â”‚   â”‚   â””â”€â”€ ...å…¶ä»–...
â”‚   â”œâ”€â”€ workshop/
â”‚   â””â”€â”€ ...å…¶ä»–...
â”œâ”€â”€ badlands-setting/
â”‚   â””â”€â”€ ...å…¶ä»–è‡ªå·±ç¼–å†™çš„è¾…åŠ©å­¦ä¹ è¯´æ˜æ–‡ä»¶...
â”œâ”€â”€ dev_run.py             â† âœ”ï¸ è¿è¡Œæ¨¡å‹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ install_badlands.bat   â† âœ”ï¸ ä¸€é”®ç¯å¢ƒå®‰è£…
â”œâ”€â”€ .vscode/
â”‚   â””â”€â”€ launch.json        â† âœ”ï¸ è°ƒè¯•é…ç½®
â””â”€â”€å…¶å®ƒæ–‡ä»¶

# æ‰¹å¤„ç†å®‰è£…
## Anaconda PowerShell è¿è¡Œ 
åœ¨ badlands è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œï¼š
conda install setuptools
conda install -c anaconda python=3.8
pip install distutils

## å®‰è£…å¤±è´¥åé‡æ–°å®‰è£…éœ€è¦æ¸…ç†
é‡æ–°è¿è¡Œ .bat ä¹‹å‰ï¼Œæ¸…ç†æ—§å¤±è´¥æ®‹ç•™ï¼ˆå¯é€‰ï¼‰ï¼š
conda deactivate
rd /s /q D:\code-python\badlands\badlands-master\build
rd /s /q D:\code-python\badlands\badlands-master\badlands.egg-info

æœ€åæ£€æŸ¥
## æˆåŠŸåè¿è¡Œï¼š

conda activate badlands
python -c "import badlands; print('Badlands is installed.')"

## å†æµ‹è¯•è¿è¡Œï¼š
python dev_run.py

# é”™è¯¯é›†é”¦
## badlands-companion å®‰è£…å¤±è´¥ï¼ˆç¼ºå°‘ distutilsï¼‰
âŒ é”™è¯¯ 2ï¼šbadlands-companion å®‰è£…å¤±è´¥ï¼ˆç¼ºå°‘ distutilsï¼‰
ğŸ’¡ é”™è¯¯æç¤ºï¼š
vbnet
å¤åˆ¶
ç¼–è¾‘
ModuleNotFoundError: No module named 'distutils.msvccompiler'
âœ… åŸå› ï¼š
Anaconda é»˜è®¤å¹¶ä¸å®‰è£… distutilsã€‚è¯¥æ¨¡å—åœ¨ Python 3.10+ è¢«æ‹†åˆ†å‡º stdlibï¼Œå¦‚æœ companion é¡¹ç›®ä»ä½¿ç”¨è€å¼ setup.py + numpy.distutilsï¼Œä½ éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š

âœ… è§£å†³åŠæ³•ï¼š
åœ¨ badlands è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œï¼š

bash
å¤åˆ¶
ç¼–è¾‘
conda install setuptools
conda install -c anaconda python=3.8
pip install distutils
æˆ–è€…æ›´ç¨³å¦¥ï¼š

bash
å¤åˆ¶
ç¼–è¾‘
pip install setuptools==59.5.0



# âœ… å®‰è£…ä¾èµ–
   å¿…è¦ä¾èµ–ï¼š
   Python 3.8
   VSCode ç¼–è¾‘å™¨
   Anaconda

1 vscode è™šæ‹Ÿç¯å¢ƒ python ç‰ˆæœ¬ 3.8
2 ä¸‹è½½å¹¶å®‰è£… Anaconda3-2024.10-1-Windows-x86_64.exe
é“¾æ¥: https://www.anaconda.com/download/success
3 éªŒè¯ conda å®‰è£…:

# ğŸ“¥ å…‹éš† Badlands é¡¹ç›®
vscode ç»ˆç«¯è¿è¡Œ:

è¿›å…¥ç›®å½• ruolin\bandlands-master

## badlands ä¸»ç¨‹åº
git clone https://github.com/EELIC/badlands.git
git clone https://github.com/badlands-model/badlands.git
## badlands_companion  
- badlands_companion æ˜¯ Badlands å›¢é˜Ÿå¼€å‘çš„ è¾…åŠ©å·¥å…·åº“ï¼Œé»˜è®¤å¹¶ä¸åŒ…å«åœ¨ badlands ä¸»åº“ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„ GitHub ä»“åº“ï¼š
  ç›®çš„ æä¾›ç½‘æ ¼ç”Ÿæˆã€å¯è§†åŒ–ã€å‰–é¢åˆ†æç­‰åŠŸèƒ½
  ä¸‹è½½æ–‡ä»¶
git clone https://github.com/badlands-model/badlands-companion.git
 
è¿›å…¥æ–‡ä»¶å¤¹ badlands-master\badlands>
å¤åˆ¶ environment.ymlåˆ°æ–‡ä»¶å¤¹

## å®‰è£…ç¤ºä¾‹æ–‡ä»¶ badlands-workshop
git clone https://github.com/badlands-model/badlands-workshop.git

# windowsä¿®æ”¹ç›®å½•ç»“æ„

badlands-master/
â”œâ”€â”€ badlands/                 â† æºç ä¸»åŒ…ï¼Œç»Ÿä¸€æ”¾è¿™é‡Œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ model.py
â”‚   â””â”€â”€ ...å…¶ä»–æ¨¡å—...
â”œâ”€â”€ setup.py
â”œâ”€â”€ setup.cfg
â”œâ”€â”€ README.md
â”œâ”€â”€ environment.yml
â”œâ”€â”€ work/
â”‚   â””â”€â”€ examples/
â”‚       â””â”€â”€ basin/
â”‚           â””â”€â”€ basin.xml
â””â”€â”€ companion/

### ä¿®æ”¹è¯´æ˜
æ‰€æœ‰ä»£ç æ”¾åœ¨ badlands/ åŒ…ä¸­ï¼šç¬¦åˆ setuptools æ¨èåšæ³•ï¼›

å®‰è£…è·¯å¾„æ¸…æ™°ï¼Œé¿å… ../README.md éæ³•è·¨è·¯å¾„ï¼›

ä½¿ç”¨ setup.cfg + æœ€ç®€ setup.pyï¼šå…¼å®¹æ€§å¼ºã€é¿å… dash-deprecated è­¦å‘Šï¼›

install_requires æ”¾åœ¨ setup.cfg é‡Œæ›´æ¸…æ™°ï¼Œé¿å…æ‰‹åŠ¨ç®¡ç† requirements.txtã€‚

# å°è¯•è‡ªåŠ¨æ‰¹å¤„ç†å®‰è£…
ruolin\badlands-setting> setup_badlands_full.bat

# ğŸ åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ 
## æ•´åˆå¹¶æµ‹è¯•å…¼å®¹æ€§ åçš„æœ€å°å¯è¡Œ environment.ymlï¼ŒåŸºäºï¼š

Python 3.8ï¼ˆå…¼å®¹ Badlandsï¼‰
Numpy 1.21
SciPy é™åˆ¶ä¸º 1.9.3ï¼ˆæœ€åå…¼å®¹ 3.8 çš„ç¨³å®šç‰ˆæœ¬ï¼‰
é¿å…ä½¿ç”¨ m2w64-gcc-libs ç­‰ Windows ä¸‹æ˜“å†²çªåŒ…
å°½é‡ä½¿ç”¨ conda-forge æä¾›çš„åŒ…ï¼ˆæ›´ç¨³å®šï¼‰

## ä½¿ç”¨condaè‡ªå¸¦pythonç¼–è¯‘å™¨ åˆ›å»ºå…¼å®¹çš„ Conda ç¯å¢ƒ 
æ‰“å¼€Anaconda PowerShell Prompt
### æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒ
conda env list
### å¦‚æœå­˜åœ¨ badlands è¿›å…¥å¸è½½
## å¸è½½å®‰è£…(å®‰è£…å¤±è´¥,é‡æ–°å®‰è£…æ—¶éœ€è¦å…ˆå¸è½½åŸæœ‰ç¯å¢ƒ)
conda env remove -n badlands
## conda deactivate ç¦ç”¨ç¯å¢ƒ

## ğŸ“¦ æ­£å¸¸å®‰è£… badlands Python ä¾èµ–
Anaconda PowerShell Prompt è¿›å…¥è·¯å¾„ï¼š ruolin\bandlands-master\main\ 
conda env create --file environment.yml  

## (å‡ºç°é”™è¯¯æ­¥éª¤) æ¿€æ´»å·²æœ‰ç¯å¢ƒå¹¶å®‰è£… environment.yml ä¸­çš„ä¾èµ–(å¦‚æœå‘ç°æŸäº›ä¾èµ–ç¼ºå¤±çš„è¯--é€šå¸¸æ˜¯å¤–ç½‘ä¸‹åŒ…çš„ç½‘ç»œè¿æ¥é—®é¢˜)
conda env update --file environment.yml --prune

## æ¿€æ´» badlandsç¯å¢ƒ
conda activate badlands

## éªŒè¯å®‰è£…æˆåŠŸ
conda env list 
![condaç¯å¢ƒå®‰è£…éªŒè¯æˆåŠŸå›¾ç‰‡](/res/conda_env_success.png "conda_env_success")

## âš™ï¸ ç¼–è¯‘ badlands
python setup.py install
![pyå®‰è£…éªŒè¯æˆåŠŸå›¾ç‰‡](/res/py_install_success.png "py_install_success")

## éªŒè¯å®‰è£…
è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æ˜¯å¦æˆåŠŸå®‰è£…ï¼š
python -c "import badlands; print(badlands.__file__)"
å¦‚æœè·¯å¾„æ­£ç¡®è¾“å‡º .py æˆ– .pyc æ–‡ä»¶è·¯å¾„ï¼Œåˆ™ä¸€åˆ‡å°±ç»ªã€‚

æˆåŠŸæç¤º : Processing dependencies for badlands==2.0
Finished processing dependencies for badlands==2.0

# å¯èƒ½å­˜åœ¨çš„é—®é¢˜

## å®‰è£… badlands_companion.toolGeo è„šæœ¬ä¾èµ–çš„å¯è§†åŒ–åº“ plotly

conda install -c plotly plotly

æœ¬åœ°å…‹éš† + åŠ å…¥è·¯å¾„ å…‹éš†æºç ï¼Œæ‰‹åŠ¨æ·»åŠ åˆ° sys.path

([ å½“å‰è·¯å¾„](badlands-master\badlands-companion))
python
import sys
sys.path.append('../badlands-companion')
import badlands_companion.toolGeo as simple

### ï¼šé™çº§ NumPy åˆ° 1.26.4
pip install numpy==1.26.4
ç¡®è®¤å®‰è£…ç‰ˆæœ¬ï¼š 
python -c "import numpy; print(numpy.__version__)"
****** è¾“å‡ºåº”ä¸ºï¼š1.26.4

# è¿è¡Œ
## æ¿€æ´»ç°æœ‰ç¯å¢ƒï¼š

conda activate badlands
å›åº”:
**********************************************************************
** Visual Studio 2019 Developer Command Prompt v16.11.16
** Copyright (c) 2021 Microsoft Corporation
**********************************************************************
[vcvarsall.bat] Environment initialized for: 'x64'

## æ£€æŸ¥ç°æœ‰ç¯å¢ƒæ˜¯å¦å·²å®‰è£…å¥½ Badlands

python -c "import badlands; print('Badlands is installed.')"
å¦‚æœå·²ç»æ¿€æ´» å›åº” Badlands is installed.

## è¿è¡Œå‚è€ƒç¤ºä¾‹

åˆ‡æ¢ç›®å½• badlands-master\
python -m badlands.badlands.model run -i badlands-workshop/examples/basin/basin.xml
python -m badlands.badlands.model run -i badlands-workshop/examples/basin/basin.xml

è¯¥å‘½ä»¤çš„å«ä¹‰æ˜¯ï¼š

-m badlands.modelï¼šé€šè¿‡æ¨¡å—æ–¹å¼è¿è¡Œï¼›

runï¼šæ‰§è¡Œæ¨¡å‹ï¼›

-i basin.xmlï¼šè¾“å…¥ XML æ¨¡å‹é…ç½®ã€‚

è‹¥æ‰§è¡Œåç›®å½•ä¸‹å‡ºç° .h5 è¾“å‡ºæ–‡ä»¶ï¼Œå¦‚ basin.ncã€basin_topo.h5ï¼Œè¡¨ç¤ºè¿è¡ŒæˆåŠŸã€‚


# å‚è€ƒèµ„æ–™

## Conda
ğŸ ä»€ä¹ˆæ˜¯ Condaï¼Ÿ
Conda æ˜¯ä¸€ä¸ªå¼€æºçš„è·¨å¹³å°åŒ…ç®¡ç†å™¨å’Œç¯å¢ƒç®¡ç†å·¥å…·ï¼Œç”¨äºï¼š

å®‰è£…ã€è¿è¡Œå’Œæ›´æ–° Pythonï¼ˆæˆ–å…¶ä»–è¯­è¨€ï¼‰çš„åŒ…ï¼›

åˆ›å»ºã€éš”ç¦»ã€ç®¡ç†è™šæ‹Ÿç¯å¢ƒï¼›

è‡ªåŠ¨è§£å†³ä¾èµ–å†²çªï¼Œæ¯” pip æ›´æ™ºèƒ½ã€‚

ğŸ§© Conda VS pip çš„åŒºåˆ«
åŠŸèƒ½	Conda	pip
åŒ…ç®¡ç†	æ”¯æŒ Python + é Pythonï¼ˆå¦‚ Cåº“ï¼‰	ä»…æ”¯æŒ Python åŒ…
ä¾èµ–ç®¡ç†èƒ½åŠ›	å¼ºï¼Œè‡ªåŠ¨è§£å†³ä¾èµ–	å¼±ï¼Œå®¹æ˜“å†²çª
å®‰è£…é€Ÿåº¦	å¿«ï¼ˆç”¨é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶åŒ…ï¼‰	æ…¢ï¼ˆéœ€æºç ç¼–è¯‘ï¼‰
ç¯å¢ƒéš”ç¦»èƒ½åŠ›	å¼º	éœ€è¦å€ŸåŠ© virtualenv æˆ– venv

ğŸ› ï¸ Conda å¸¸ç”¨å‘½ä»¤
ğŸŒ± ç¯å¢ƒç®¡ç†
bash
å¤åˆ¶
ç¼–è¾‘
### åˆ›å»ºæ–°ç¯å¢ƒ
conda create -n myenv python=3.9

### æ¿€æ´»ç¯å¢ƒ
conda activate myenv

### é€€å‡ºç¯å¢ƒ
conda deactivate

### åˆ é™¤ç¯å¢ƒ
conda remove -n myenv --all

### å…‹éš†ç¯å¢ƒ
conda create --name myenv2 --clone myenv

### æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒ
conda env list
ğŸ“¦ åŒ…ç®¡ç†
bash
å¤åˆ¶
ç¼–è¾‘
### å®‰è£…åŒ…
conda install numpy

### æŒ‡å®šé€šé“å®‰è£…
conda install -c conda-forge matplotlib

### å‡çº§åŒ…
conda update numpy

### åˆ é™¤åŒ…
conda remove scipy

### æœç´¢åŒ…
conda search pandas
ğŸ“„ ä½¿ç”¨ environment.yml æ–‡ä»¶
bash
å¤åˆ¶
ç¼–è¾‘
### ä» YML æ–‡ä»¶åˆ›å»ºç¯å¢ƒ
conda env create -f environment.yml

### æ›´æ–°å·²æœ‰ç¯å¢ƒ
conda env update -f environment.yml --prune

### å¯¼å‡ºå½“å‰ç¯å¢ƒ
conda env export > environment.yml
ğŸ”— å¤šé€šé“ï¼ˆæºï¼‰
é»˜è®¤ Conda ä½¿ç”¨å®˜æ–¹æºï¼Œå»ºè®®æ·»åŠ  conda-forgeï¼š

å¤åˆ¶
ç¼–è¾‘
conda config --add channels conda-forge
conda config --set channel_priority strict

## pyproject.toml 
pyproject.toml  æ˜¯ Python é¡¹ç›®çš„æ ‡å‡†æ„å»ºé…ç½®æ–‡ä»¶ï¼Œç”¨äºå£°æ˜å¦‚ä½•æ„å»ºã€æ‰“åŒ…å’Œå®‰è£…ä½ çš„é¡¹ç›®ã€‚